<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Glossary Test - Main Text</title>
  <link rel="stylesheet" href="../../styles/custom.css" />
</head>
<body>
  <h1>Glossary Test - Main Text</h1>

  <div id="main-text">
    <p>
      The NPS manages many national parks. Scientists from NOAA study environmental changes. This miniature painting was done on mica.
    </p>
  </div>

  <div id="glossary-section"></div>

  <script type="module">
    try {
      // Import existing glossary scripts
      const termsModule = await import('../../app/js/glossary-terms.js');
      const functionsModule = await import('../../app/js/glossary-functions.js');

      const mainDiv = document.getElementById("main-text");
      const glossaryDiv = document.getElementById("glossary-section");

      if (!mainDiv || !glossaryDiv) {
        console.error("Main text or glossary section not found!");
        return;
      }

      // Get text content
      const textToScan = mainDiv.textContent || "";

      // Identify matches using your function
      const matches = functionsModule.identifyGlossaryMatches(textToScan, termsModule.glossaryTerms);

      // Highlight terms in the main text
      mainDiv.innerHTML = functionsModule.highlightGlossaryTermsString(textToScan, matches);

      // Render glossary panel
      functionsModule.renderGlossary(matches, glossaryDiv);

      // Attach tooltips
      functionsModule.attachGlossaryTooltips(mainDiv);

      console.log("Glossary matches:", matches);

    } catch (e) {
      console.error("Error loading glossary scripts:", e);
    }
  </script>
</body>
</html>
